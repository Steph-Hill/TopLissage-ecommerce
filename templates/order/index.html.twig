{% extends 'base.html.twig' %}

{% block title %}
    Hello OrderController!
{% endblock %}

{% block body %}
    <div class="container">
        {{ form_start(form, { action: path('order_prepare') }) }}

        <h1>Ma Commande</h1>

        <div class="mt-4">
            <p>Choisir votre adresse de livraison</p>
            <div class="row">
                <div class="col-md-6">
                    {{ form_row(form.addresses) }}
                </div>
            </div>
        </div>

        <div class="mt-4">
            <p>Choisir votre Transporteur</p>
            <div class="row">
                <div class="col-md-6">
                    {{ form_row(form.transporter) }}
                </div>
            </div>
        </div>

        <div class="mt-4">
            <h2>Récapitulatif de la commande</h2>
            {% set total = null %}
            {% for product in recapCart %}
                {% set total = total + (product.product.price * product.quantity) %}
                <div class="row border-top py-4">
                    <div class="col-md-6">
                        <h3>{{ product.product.name }}</h3>
                        <p>Quantité: {{ product.quantity }}</p>
                        <p>Prix du produit: {{ (product.product.price / 100)|number_format(2, ',', '.') }} €</p>
                    </div>
                    <div class="col-md-6">
                        <a class="btn btn-danger" href="{{ path('cart_remove', { id: product.product.id }) }}">Enlever</a>
                    </div>
                </div>
            {% endfor %}
        </div>

        <div class="mt-4">
            <div class="row border-top py-4">
                <div class="col-md-6">
                    <h2>Total: {{ (total / 100)|number_format(2, ',', '.') }} €</h2>
                </div>
                <div class="col-md-6">
                    <button type="submit" class="btn btn-primary">Valider votre commande</button>
                </div>
            </div>
        </div>

        {{ form_end(form) }}

        <div class="mt-4">
            <a href="{{ path('cart_removeAll') }}">
                <button class="btn btn-danger">Supprimer tout</button>
            </a>
        </div>
    </div>
{% endblock %}
